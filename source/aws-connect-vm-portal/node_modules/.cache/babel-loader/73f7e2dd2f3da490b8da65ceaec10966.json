{"ast":null,"code":"import _classCallCheck from\"/home/ec2-user/environment/aws-connect-voicemail/source/aws-connect-vm-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/ec2-user/environment/aws-connect-voicemail/source/aws-connect-vm-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/ec2-user/environment/aws-connect-voicemail/source/aws-connect-vm-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/ec2-user/environment/aws-connect-voicemail/source/aws-connect-vm-portal/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/******************************************************************************\n *  Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.                                           *                                                                                                                   *\n *  Licensed under the Apache License Version 2.0 (the 'License'). You may not\n *  use this file except in compliance with the License. A copy of the License\n *  is located at                                                            \n *                                                                                                                   \n *      http://www.apache.org/licenses/                                                                                   *                                                                                                                  \n *  or in the 'license' file accompanying this file. This file is distributed on\n *  an 'AS IS' BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or\n *  implied. See the License for the specific language governing permissions and\n *  limitations under the License.                                                                                \n******************************************************************************/import React from'react';import{connect}from'react-redux';import history from\"../history\";import{Auth}from\"aws-amplify\";import{AuthAction}from\"../store/actions/auth.actions\";export default function(ComposedComponent,UnauthedComponent){var Authenticate=/*#__PURE__*/function(_React$Component){_inherits(Authenticate,_React$Component);var _super=_createSuper(Authenticate);function Authenticate(props){var _this;_classCallCheck(this,Authenticate);_this=_super.call(this,props);_this.state={authState:'loading'};return _this;}_createClass(Authenticate,[{key:\"componentDidMount\",value:function componentDidMount(){this._checkAndRedirect();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){this._checkAndRedirect();}},{key:\"_checkAndRedirect\",value:function _checkAndRedirect(){var _this2=this;if(this.state.authState===\"loading\"){Auth.currentAuthenticatedUser().then(function(user){_this2.props.auth(user);_this2.setState({authState:'valid'});}).catch(function(e){_this2.setState({authState:'invalid'});_this2.props.redirect();});}}},{key:\"render\",value:function render(){return this.state.authState==='valid'?/*#__PURE__*/React.createElement(ComposedComponent,this.props):/*#__PURE__*/React.createElement(UnauthedComponent,this.props);}}]);return Authenticate;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{auth:state.auth};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{redirect:function redirect(){return dispatch(function(){history.push(\"/login\");});},auth:function auth(user){return dispatch(AuthAction.auth(user));}};};return connect(mapStateToProps,mapDispatchToProps)(Authenticate);}","map":{"version":3,"names":["React","connect","history","Auth","AuthAction","ComposedComponent","UnauthedComponent","Authenticate","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","state","authState","_createClass","key","value","componentDidMount","_checkAndRedirect","componentDidUpdate","_this2","currentAuthenticatedUser","then","user","auth","setState","catch","e","redirect","render","createElement","Component","mapStateToProps","mapDispatchToProps","dispatch","push"],"sources":["/home/ec2-user/environment/aws-connect-voicemail/source/aws-connect-vm-portal/src/common/requiresAuth.js"],"sourcesContent":["/******************************************************************************\n *  Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.                                           *                                                                                                                   *\n *  Licensed under the Apache License Version 2.0 (the 'License'). You may not\n *  use this file except in compliance with the License. A copy of the License\n *  is located at                                                            \n *                                                                                                                   \n *      http://www.apache.org/licenses/                                                                                   *                                                                                                                  \n *  or in the 'license' file accompanying this file. This file is distributed on\n *  an 'AS IS' BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or\n *  implied. See the License for the specific language governing permissions and\n *  limitations under the License.                                                                                \n******************************************************************************/\n\nimport React from 'react';\nimport {connect} from 'react-redux';\nimport history from \"../history\";\nimport {Auth} from \"aws-amplify\";\nimport {AuthAction} from \"../store/actions/auth.actions\";\n\nexport default function (ComposedComponent, UnauthedComponent) {\n    class Authenticate extends React.Component {\n        constructor(props) {\n            super(props);\n            this.state = {\n                authState: 'loading'\n            }\n        }\n\n        componentDidMount() {\n            this._checkAndRedirect();\n        }\n\n        componentDidUpdate() {\n            this._checkAndRedirect();\n        }\n\n        _checkAndRedirect() {\n            if (this.state.authState === \"loading\") {\n                Auth.currentAuthenticatedUser().then(user => {\n                    this.props.auth(user);\n                    this.setState({authState: 'valid'});\n                }).catch(e => {\n                    this.setState({authState: 'invalid'});\n                    this.props.redirect();\n                });\n            }\n        }\n\n        render() {\n            return this.state.authState === 'valid' ?\n                <ComposedComponent {...this.props} /> : <UnauthedComponent {...this.props}/>;\n        }\n    }\n\n    const mapStateToProps = (state) => {\n        return {\n            auth: state.auth\n        };\n    };\n\n    const mapDispatchToProps = (dispatch) => {\n        return {\n            redirect: () => dispatch(() => {history.push(\"/login\")}),\n            auth: (user) => dispatch(AuthAction.auth(user))\n        }\n    };\n\n    return connect(\n        mapStateToProps,\n        mapDispatchToProps\n    )(Authenticate);\n}\n"],"mappings":"gwBAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+EAEA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAAQC,OAAO,KAAO,aAAa,CACnC,MAAO,CAAAC,OAAO,KAAM,YAAY,CAChC,OAAQC,IAAI,KAAO,aAAa,CAChC,OAAQC,UAAU,KAAO,+BAA+B,CAExD,cAAe,UAAUC,iBAAiB,CAAEC,iBAAiB,CAAE,IACrD,CAAAC,YAAY,uBAAAC,gBAAA,EAAAC,SAAA,CAAAF,YAAA,CAAAC,gBAAA,MAAAE,MAAA,CAAAC,YAAA,CAAAJ,YAAA,EACd,SAAAA,aAAYK,KAAK,CAAE,KAAAC,KAAA,CAAAC,eAAA,MAAAP,YAAA,EACfM,KAAA,CAAAH,MAAA,CAAAK,IAAA,MAAMH,KAAK,EACXC,KAAA,CAAKG,KAAK,CAAG,CACTC,SAAS,CAAE,SACf,CAAC,QAAAJ,KAAA,CACL,CAACK,YAAA,CAAAX,YAAA,GAAAY,GAAA,qBAAAC,KAAA,CAED,SAAAC,kBAAA,CAAoB,CAChB,IAAI,CAACC,iBAAiB,EAAE,CAC5B,CAAC,GAAAH,GAAA,sBAAAC,KAAA,CAED,SAAAG,mBAAA,CAAqB,CACjB,IAAI,CAACD,iBAAiB,EAAE,CAC5B,CAAC,GAAAH,GAAA,qBAAAC,KAAA,CAED,SAAAE,kBAAA,CAAoB,KAAAE,MAAA,MAChB,GAAI,IAAI,CAACR,KAAK,CAACC,SAAS,GAAK,SAAS,CAAE,CACpCd,IAAI,CAACsB,wBAAwB,EAAE,CAACC,IAAI,CAAC,SAAAC,IAAI,CAAI,CACzCH,MAAI,CAACZ,KAAK,CAACgB,IAAI,CAACD,IAAI,CAAC,CACrBH,MAAI,CAACK,QAAQ,CAAC,CAACZ,SAAS,CAAE,OAAO,CAAC,CAAC,CACvC,CAAC,CAAC,CAACa,KAAK,CAAC,SAAAC,CAAC,CAAI,CACVP,MAAI,CAACK,QAAQ,CAAC,CAACZ,SAAS,CAAE,SAAS,CAAC,CAAC,CACrCO,MAAI,CAACZ,KAAK,CAACoB,QAAQ,EAAE,CACzB,CAAC,CAAC,CACN,CACJ,CAAC,GAAAb,GAAA,UAAAC,KAAA,CAED,SAAAa,OAAA,CAAS,CACL,MAAO,KAAI,CAACjB,KAAK,CAACC,SAAS,GAAK,OAAO,cACnCjB,KAAA,CAAAkC,aAAA,CAAC7B,iBAAiB,CAAK,IAAI,CAACO,KAAK,CAAI,cAAGZ,KAAA,CAAAkC,aAAA,CAAC5B,iBAAiB,CAAK,IAAI,CAACM,KAAK,CAAG,CACpF,CAAC,WAAAL,YAAA,GA/BsBP,KAAK,CAACmC,SAAS,EAkC1C,GAAM,CAAAC,eAAe,CAAG,QAAlB,CAAAA,eAAeA,CAAIpB,KAAK,CAAK,CAC/B,MAAO,CACHY,IAAI,CAAEZ,KAAK,CAACY,IAChB,CAAC,CACL,CAAC,CAED,GAAM,CAAAS,kBAAkB,CAAG,QAArB,CAAAA,kBAAkBA,CAAIC,QAAQ,CAAK,CACrC,MAAO,CACHN,QAAQ,CAAE,SAAAA,SAAA,QAAM,CAAAM,QAAQ,CAAC,UAAM,CAACpC,OAAO,CAACqC,IAAI,CAAC,QAAQ,CAAC,EAAC,CAAC,GACxDX,IAAI,CAAE,SAAAA,KAACD,IAAI,QAAK,CAAAW,QAAQ,CAAClC,UAAU,CAACwB,IAAI,CAACD,IAAI,CAAC,CAAC,EACnD,CAAC,CACL,CAAC,CAED,MAAO,CAAA1B,OAAO,CACVmC,eAAe,CACfC,kBAAkB,CACrB,CAAC9B,YAAY,CAAC,CACnB"},"metadata":{},"sourceType":"module"}